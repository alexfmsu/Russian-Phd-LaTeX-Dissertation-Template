\chapter{Определение размерности темного подпространства пространства многоуровневых атомных ансамблей}\label{ch:ch4}

\section{Введение}\label{sec:ch4/sect1}

Темные состояния атомных ансамблей не взаимодействуют со светом: не излучают и не поглощают фотоны по причине возникающей деструктивной интерференции. В силу своей устойчивости к декогеренции, они могут быть широко использованы в квантовых вычислениях, в частности, для создания долговременной квантовой памяти. На сегодняшний день структура темных состояний двухуровневых атомов достаточно хорошо изучена. Для ансамблей многоуровневых атомов вопрос об их структуре по-прежнему остается открытым.

В работе \cite{dark_states_dimension} было установлено, что размерность темного подпространства пространства ансамблей двухуровневых атомов соответствует числам Каталана. Утверждение аналогичного характера об общем виде темных состояний трехуровневых атомов сформулировано, однако его строгое доказательство представляется весьма трудоемким и к настоящему времени не проведено.

В данной главе будет представлен алгоритм численного определения раз­мерности темного подпространства для ансамблей, состоящих из ограниченного числа трехуровневых атомов.

Рассмотрим модель Тависа-Каммингса \cite{tc_exact_solution,tc_a_study,tc_dicke_2,tc_improvement,tc_experimental}, описывающую взаимодействие идентичных атомов с фотонами в оптическом резонаторе. Ее гамильтониан в случае слабого
взаимодействия $g \ll \hbar w$ (приближения RWA \cite{ozhigov_qq,rwa_rabi_1,rwa_rabi_2}) имеет следующий вид:
\begin{equation}
H_{\text{TC}}^{\text{RWA}} = \hbar w_{c}a^{+}a + \hbar w_{a} \sum_{i=1}^{n}\s_{i}^{+}\s_{i} + \sum_{i=1}^{n}g_{i}(a^{+}\s_{i} + a\s^{+}_{i}),
\end{equation}
где
\begin{itemize}
	\item[$\bullet$]{$\hbar$ -- постоянная Планка,}
	\item[$\bullet$]{$w_{c}$ -- частота фотонов моды резонатора,}
	\item[$\bullet$]{$w_{a}$ -- частота атомного перехода,}
	\item[$\bullet$]{$g_{i}$ -- сила взаимодействия $i$-го атома с полем,}
	\item[$\bullet$]{$n$ --  число атомов в полости,}
	\item[$\bullet$]{$a^{+}, a$ -- операторы рождения и уничтожения фотона в полости \cite{messia}:\\
		\begin{equation}
			a^{+}|m\ra = \sqrt{m+1}|m+1\ra,\qquad\qquad a|m\ra = \sqrt{m}|m-1\ra,
		\end{equation}
		\begin{center}($m$ -- количество фотонов в полости)\end{center}
		\
		
		\begin{equation}
			a =
			\bordermatrix{
				& |0\ra & |1\ra & |2\ra & \cdots & |m-1\ra & |m\ra \cr
				|0\ra & 0 & 1 & 0 & \cdots & \cdots & 0 \cr
				|1\ra & \vdots & 0 & \sqrt{2} & \ddots &  & \vdots \cr
				|2\ra & \vdots &  & \ddots & \ddots & \ddots & \vdots \cr
				\cdots & \vdots &  &  & \ddots & \ddots & 0 \cr
				|m-1\ra & 0 & \cdots & \cdots & \cdots & 0 & \sqrt{m} \cr
				|m\ra & 0 & \cdots & \cdots & \cdots & \cdots & 0\cr
			},
		\end{equation}
	}\\[12pt]
	\begin{equation}
		a^{+} =
		\bordermatrix{
			& |0\ra & |1\ra & |2\ra & \cdots & |m-1\ra & |m\ra \cr
			|0\ra & 0 & 0 & \cdots & \cdots & 0 & 0 \cr
			|1\ra & 1 & 0 &  &  & \vdots & \vdots \cr
			|2\ra & 0 & \sqrt{2} & \ddots & & \vdots & \vdots \cr
			\cdots & \vdots & \ddots & \ddots & \ddots & \vdots & \vdots \cr
			|m-1\ra & \vdots &  & \ddots & \ddots & 0 & \vdots \cr
			|m\ra & 0 & \cdots & \cdots & 0 & \sqrt{m} & 0\cr
		},
	\end{equation}
	\\
	\item[$\bullet$]{$\s^{+}_{i}, \s_{i}$ -- атомные операторы возбуждения и релаксации, действующие на основное и возбужденное состояния $i$-го атома соответственно:\\
		\begin{equation}
			\begin{split}
				\s_{i}|0\ra_{i} = 0,\hspace{9em}\s^{+}_{i}|0\ra_{i} = |1\ra_{i},\\
				\s_{i}|1\ra_{i} = |0\ra_{i},\hspace{8em}\s^{+}_{i}|1\ra_{i} = 0.\hspace{1em}
			\end{split}
		\end{equation}
		
	}
\end{itemize}
\
\\[12pt]
Для двухуровневых атомов операторы $\s^{+}_{i}$ и $\s_{i}$ имеют следующий вид:
\begin{equation}
	\s_{i} = \bordermatrix{
		& |0\ra_{i} & |1\ra_{i} \cr 
		|0\ra_{i} & 0 & 1 \cr 
		|1\ra_{i} & 0 & 0 \cr
	},
	\qquad\qquad
	\s_{i}^{+} = \bordermatrix{ 
		& |0\ra_{i} & |1\ra_{i} \cr
		|0\ra_{i} & 0 & 0 \cr
		|1\ra_{i} & 1 & 0 \cr 
	}.
\end{equation}

Для простоты будем считать, что частота фотона $w_{c}$ отличается от частоты атомного
перехода $w_{a}$ на величину небольшой расстройки $|w_{c} - w_{a}| \ll w_{c}$ и, кроме того, сила взаимодействия атома с полем одинакова для всех атомов:
\[
g_{i} = g\qquad\forall i = \overline{1,~n}.
\]

Также обозначим через $\overline{\s}$ и $\overline{\s}^{+}$ операторы, действующие на атомный ансамбль:

\begin{flalign}
\begin{aligned}
& \overline{\s} = \sum_{i=1}^{n}{\s_{i}} = \s_{1} \otimes I_{2}  \otimes \dots \otimes I_{n} + \dots + I_{1} \otimes \dots \otimes I_{n-1} \otimes \s_{n},\\
& \overline{\s}^{+} = \sum_{i=1}^{n}{\s^{+}_{i}} \text{определяется аналогичным образом.}
\end{aligned}
\end{flalign}


\noindent Здесь наличие оператора $\s_{j}/\s^{+}_{j}$ означает релаксацию/возбуждение $j$-го атома, наличие оператора $I_{j}$ означает отсутствие воздействия на состояние $j$-го атома. Их действие позволит нам определить возможность испускания/поглощения одиночного фотона хотя бы одним атомом ансамбля.

Только для темных состояний одновременное действие обоих операторов будет давать нулевой эффект:
\begin{equation}\label{critetion}
	\hspace{3em}\begin{cases}
		\bm{
			\overline{\s}^{+}|\Psi\ra_{\textbf{at}} = 0 \qquad \textbf{(атомы не могут поглотить фотон)}},\\
		\bm{
			\overline{\s}|\Psi\ra_{\textbf{at}} = 0 ~~\qquad \textbf{(атомы не могут испустить фотон).}}
	\end{cases}
\end{equation}
\begin{center}
$\displaystyle|\Psi\ra_{\text{at}}$ --- произвольное состояние атомного ансамбля
\end{center}

\noindent Таким образом, условие \eqref{critetion} является \textbf{критерием темноты} атомного ансамбля, что непосредственно следует из определения темного состояния.

В работе \cite{dark_states_dimension} было сформулировано и доказано утверждение о том, что размерность темного подпространства пространства $n$ двухуровневых атомов равна
\begin{equation}\label{dim_d_2_n}
	\text{dim}(D_{n}^2) =	
	\begin{cases}
		C_{n}^{k} - C_{n}^{k-1}\quad~~\text{при}~n = 2k, \\
		0 \qquad\qquad\qquad\text{в противном случае},
	\end{cases}
\end{equation}
и все наборы темных состояний (для четного числа атомов в группе) с учетом нормировки имеют вид 
\begin{equation}\label{d_2_n}
	\frac{1}{2^{n/4}}\bigotimes_{j=1}^{n/2}(|01\ra_{j}-|10\ra_{j}),
\end{equation}
где индекс $j$ означает номер пары $j = 1,\dots, n/2$ в произвольном разбиении группы из $n$ атомов.
\\[24pt]
\textbf{Приведем несколько примеров:}\\

\noindent
$n = 2$:
\begin{itemize}
	\item[$\triangledown$]{темные состояния: $|0\ra_{1}|1\ra_{2} - |1\ra_{1}|0\ra_{2}$}
	\item[$\triangledown$]{размерность темного подпространства: $C_{2}^{1} - C_{2}^{0} = 1$\\}
\end{itemize}
$n = 3$:
\begin{itemize}
	\item[$\triangledown$]{нет темных состояний\\}
\end{itemize}
$n = 4$:
\begin{itemize}
	\item[$\triangledown$]{
		темные состояния:\\
		$(|0\ra_{1}|1\ra_{2} - |1\ra_{1}|0\ra_{2})\otimes(|0\ra_{3}|1\ra_{4} - |1\ra_{3}|0\ra_{4})$\\
		$(|0\ra_{1}|1\ra_{3} - |1\ra_{1}|0\ra_{3})\otimes(|0\ra_{2}|1\ra_{4} - |1\ra_{2}|0\ra_{4})$\\
		$(|0\ra_{1}|1\ra_{4} - |1\ra_{1}|0\ra_{4})\otimes(|0\ra_{2}|1\ra_{3} - |1\ra_{2}|0\ra_{3})$
	}
	\item[$\triangledown$]{размерность темного подпространства: $C_{4}^{2} - C_{4}^{1} = 2$.}
\end{itemize}

\section{Постановка задачи}\label{sec:ch4/sect2}
Результат \eqref{d_2_n} установлен и доказан только для случая двухуровневых атомных ансамблей. Аналогичное утверждение для ансамблей трехуровневых
атомов в качестве гипотезы формулируется следующим образом:
\begin{hyp}
	\label{Th:20}Темное подпространство пространства n трехуровневых атомов есть линейная оболочка состояний $\displaystyle \bigotimes_{j=1}^{n/3}{\widehat{D}_{3}^{(j)}}$,
	где $\widehat{D}_{3}^{(j)}$ --- \textbf{трехатомное состояние, имеющее вид}
	\begin{equation}
		\sum_{\pi \in S_{3}}|\pi(1)\ra|\pi(2)\ra|\pi(3)\ra(-1)^{\s(\pi)}
	\end{equation}
	\begin{center}(разбиение $n$ атомов на тройки произвольно).\end{center}
\end{hyp}

\clearpage
\indent Примером темного состояния ансамбля трехуровневых атомов является состояние
$|\Psi\ra = |012\ra + |120\ra + |201\ra - |021\ra - |102\ra - |210\ra$ (оно же единственное).

Возвращаясь к \textbf{критерию темноты} \eqref{critetion} многоатомного квантового состояния, отметим, что множество решений системы
\begin{equation}\label{slae}
	\begin{cases}
		\overline{\s}^{+}|\Psi\ra_{\text{at}} = 0,\\
		\overline{\s}|\Psi\ra_{\text{at}} = 0,
	\end{cases} \Leftrightarrow
	Ax =
	\begin{pmatrix}
		\overline{\s}^{+}\\
		\overline{\s}
	\end{pmatrix}
	\begin{pmatrix}
		\lambda_1\\
		\dots\\
		\lambda_N\\
	\end{pmatrix} = 0
\end{equation}
однородных уравнений с соответствующей матрицей системы
$
A=\begin{pmatrix}
	\overline{\s}^{+}\\
	\overline{\s}
\end{pmatrix}
$ размерности $M \times N$ есть линейное подпространство размерности $N -
rank(A)$. 

Для случая трехуровневых атомов размерность матрицы системы равна $(M, N) = (6 \cdot 3^{n}, 3^{n})$, а размерность темного подпространства определяется как
\begin{equation}\label{dim_3_level}
\mathrm{dim}(D_{n}^{3}) = 3^{n} - rank(A).
\end{equation}

\noindent Таким образом, определение размерности темного подпространства сводится к задаче определения ранга матрицы $A$ системы для различных значений $n$.
\\[24pt]
\noindent \textbf{Рассмотрим несколько примеров}\\[12pt]
Определим размерности темного подпространства для ряда двухуровневых атомных ансамблей. По аналогии с \eqref{dim_3_level} размерность будет равна
\begin{equation}
\mathrm{dim}(D_{n}^{2}) = 2^{n} - rank(A).
\end{equation}
\
\\
\medskip\hrule\medskip
\noindent$\mathbf{n = 2:}$
\begin{equation}\label{eq:matrix2}
	{\footnotesize
		A =
		\bordermatrix{
			& |00\ra & |01\ra & |10\ra & |11\ra \cr
			& 0 & 1 & 1 & 0 \cr
			& 0 & 0 & 0 & 1 \cr
			& 0 & 0 & 0 & 1 \cr
			& 0 & 0 & 0 & 0 \cr
			& 0 & 0 & 0 & 0 \cr
			& 1 & 0 & 0 & 0 \cr
			& 1 & 0 & 0 & 0 \cr
			& 0 & 1 & 1 & 0 \cr
		}\rightarrow
		\bordermatrix{
			& |00\ra & |01\ra & |10\ra & |11\ra \cr
			& 1 & 0 & 0 & 0 \cr
			& 0 & 1 & 1 & 0 \cr
			& 0 & 0 & 0 & 1 \cr
		}
	}
\end{equation}
\quad\quad~~Решая систему \eqref{slae}, находим
{\footnotesize
	$\lambda =
	\begin{pmatrix}
		0\\
		\xi\\
		-\xi\\
		0
	\end{pmatrix}
	$
},\
\quad$D^{(2)}_p = \L(\{|01\ra - |10\ra\})$.\\[12pt]

\noindent\quad\quad~~~$\dim(D^{(2)}_p) = 2^{p} - rank(A) = 2^{2} - 3 = 1$\\

\medskip\hrule\medskip

\noindent$\mathbf{n = 3:}$
{\footnotesize
	\[
	A =
	\begin{pmatrix}
		\overline{\s}^{+}\\
		\overline{\s}
	\end{pmatrix}=
	\begin{pmatrix}
		0 & 1 & 1 & 0 & 1 & 0 & 0 & 0\\
		0 & 0 & 0 & 1 & 0 & 1 & 0 & 0\\
		0 & 0 & 0 & 1 & 0 & 0 & 1 & 0\\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
		0 & 0 & 0 & 0 & 0 & 1 & 1 & 0\\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
		1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
		1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
		0 & 1 & 1 & 0 & 0 & 0 & 0 & 0\\
		1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
		0 & 1 & 0 & 0 & 1 & 0 & 0 & 0\\
		0 & 0 & 1 & 0 & 1 & 0 & 0 & 0\\
		0 & 0 & 0 & 1 & 0 & 1 & 1 & 0\\
	\end{pmatrix}\rightarrow
	\begin{pmatrix}
		1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
		0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
		0 & 0 & 1 & 0 & 0 & 0 & 0 & 0\\
		0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
		0 & 0 & 0 & 0 & 1 & 0 & 0 & 0\\
		0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
		0 & 0 & 0 & 0 & 0 & 0 & 1 & 0\\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
	\end{pmatrix}
	\]
}
\
\\[12pt]

\noindent\qquad~~~$\dim(D^{(2)}_p) = 2^{p} - rank(A) = 2^{3} - 8 = 0$\\

\medskip\hrule\medskip
\
\\[12pt]
\noindent Перейдем к перечислению трудностей, возникающих при решении поставленной задачи, а именно задачи точного вычисления ранга сверхбольшой матрицы.\\Исходя из вышеуказанных примеров, можно отметить следующее:
\begin{itemize}
	\item[$\bullet$]{
		изначально (до процедуры приведения к ступенчатому виду) матрица состоит из нулей и единиц,}
	\item[$\bullet$]{
		матрица является сильно разреженной с множеством нулевых строк,}
	\item[$\bullet$]{
		подавляющее большинство строк матрицы нетривиальны: не соответствуют строкам единичной матрицы, в значительной части из них количество единиц сильно превосходит количество нулей,}
	\item[$\bullet$]{
		размерность матрицы в случае трехуровневой системы равна $6 \cdot 3^{n} \times 3^{n}$, поскольку возможны возбуждения и релаксации атомов трех типов --- $\s_{i}^{+\{0,1\}} / \s_{i}^{\{0,1\}}$, $\s_{i}^{+\{1,2\}} / \s_{i}^{\{1,2\}}$, $\s_{i}^{+\{0,2\}} / \s_{i}^{\{0,2\}}$.
	}
\end{itemize}
\
\\[0pt]
\noindent\textbf{Зависимость размерности матрицы системы от числа $\mathbf{n}$ атомов в ансамбле носит экспоненциальный характер:}

\noindent\begin{tabular}[t]{|p{4em}|p{5em}|p{4em}|p{9em}|p{9em}|}
	\hline
	$n$ & 3 &  & 18 & 21 \\
	\hline
	$M$ x $N$ & $162 \times 27$ & $\quad~\cdots$ & $2.3 \cdot 10^9 \times 387 \cdot 10^6$ & $62 \cdot 10^9 \times 10.4 \cdot 10^9$ \\
	\hline
\end{tabular}
\
\\[12pt]

\noindent Перечислим также возникающие вычислительные трудности:
\begin{itemize}
	\item[$\bullet$]{вещественные плотные матрицы размера $(6 \cdot 3^{n}) \times 3^{n}$, начиная уже с малых значений $n$, не умещаются целиком в оперативную память,}
	\item[$\bullet$]{алгоритм должен \textbf{точно вычислять ранг}: ошибки округления при работе с вещественными числами могут повлиять на корректность вы­числений.\\
		Такие инциденты, как
		\[
		\begin{pmatrix}
			0 & \dots & 0.3333333... & \dots \\
			0 & \dots & 0.3333334... & \dots \\
		\end{pmatrix}
		\]}приводят к неверному вычислению ранга.\\[0pt]

	Кроме того, было обнаружено, что многие существующие на сего­дняшний день алгоритмы и пакеты программ для вычисления ран­га разреженных матриц дают неверный ответ (в частности, метод $\mathsf{linalg.interpolative.estimate\_rank}$ библиотеки $\mathbf{scipy}$ начиная с $n = 9$).\\[18pt]
	Данный факт означает \textbf{необходимость вычисления ранга в целых числах}.
	\item[$\bullet$]{применение алгоритма Гаусса приведения матрицы к ступенчатому ви­ду занимает неприемлемо большое вычислительное время и не может быть использовано для матриц подобных размеров.}
\end{itemize}

\section{Описание алгоритма}\label{sec:ch4/sect3}

Перейдем непосредственно к описанию предложенного алгоритма.
Он будет состоять из трех частей:
\begin{enumerate}
	\item{построение разреженной матрицы системы $A$};
	\item{целочисленное приведение разреженной матрицы к ступенчатой форме путем редуцирования соответствующего ей графа};
	\item{окончательное целочисленное приведение матрицы к ступенчатой форме с помощью
		алгоритма Гаусса}.
\end{enumerate}

\subsection{Построение разреженной матрицы системы}\label{subsec:ch4/subsect1}
Генерация разреженных матриц для различных $n = 3\dots21$ выполняется стандартным
образом с использованием научного пакета Python SciPy для разреженных матриц.

Каждая строка содержит номера столбцов ненулевых элементов (нумерация столбцов
начинается с нуля). Полностью нулевые строки плотной матрицы пропускаются.

К примеру, для системы \eqref{eq:matrix2} разреженная матрица записывается в следующем виде:
\begin{flushleft}
	\noindent \qquad 1,2\\
	\noindent\qquad 3,\\
	\noindent\qquad 3,\\
	\noindent\qquad 0,\\
	\noindent\qquad 0,\\
	\noindent\qquad 1,2\\
\end{flushleft}\label{eq:sparse_matrix2}
\
\\[12pt]
\noindent Для трехуровневой системы построение выполняется аналогично.

\clearpage
\noindent Выпишем характерные метрики после первого этапа алгоритма:

\noindent
{\footnotesize
	\begin{tabular}[t]{|p{5em}|p{3em}|p{4em}|p{5em}|p{5em}|p{5em}|p{5em}|p{5em}|}
		\hline
		$n$ & 3 & 6 & 9 & 12 & 15 & 18 & 21 \\
		\hline
		$\mathrm{M}$ & 162 & 4374 & $118 \cdot 10^{3}$ & $3.2 \cdot 10^{6}$ & $86.1 \cdot 10^{6}$ & $2.3 \cdot 10^{9}$ & $62.7 \cdot 10^{9}$ \\
		\hline
		$\mathrm{N}$ & 27 & 729 & $19.6 \cdot 10^{3}$ & $531.4 \cdot 10^{3}$ & $14.3 \cdot 10^{6}$ & $387.4 \cdot 10^{6}$ & $10.4 \cdot 10^{9}$ \\
		\hline
		$\mathbf{nrows}$ & 114 & 3990 & $\approx M$ & $\cdots$ & $\cdots$ & $\cdots$ & $\approx M$ \\
		\hline
		$\mathbf{nonzeros}$ & 162 & 8748 & $354.3 \cdot 10^{3}$ & $12.7 \cdot 10^{6}$ & $430.4 \cdot 10^{6}$ & $13.9 \cdot 10^{9}$ & $439.3 \cdot 10^{9}$ \\
		\hline
	\end{tabular}
}

\begin{itemize}
	\item[$\bullet$]{$n$  --- кол-во атомов},
	\item[$\bullet$]{$\mathrm{M}$ --- кол-во строк в плотной\footnote[1]{плотные матрицы не создаются} матрице,}
	\item[$\bullet$]{$\mathrm{N}$ --- кол-во столбцов в плотной матрице,}
	\item[$\bullet$]{$\mathbf{nrows}$  --- кол-во строк в разреженной матрице,}
	\item[$\bullet$]{$\mathbf{nonzeros}$ --- кол-во ненулевых элементов (единиц) в разреженной матрице.}
\end{itemize}
\
\\[0pt]
\noindent Как мы видим, для $n = 21$ разреженная матрица системы содержит несколько десятков миллиардов строк.

\subsection{Элементарные преобразования над матрицей системы путем редукции соответствующего ей графа}\label{subsec:ch4/subsect2}

Для разреженной матрицы системы построим граф по следующей схеме:
\begin{itemize}
	\item[$\bullet$]{значение вершины --- номер строки в разреженной матрице,}
	\item[$\bullet$]{метка ребра, входящего в вершину, содержит позиции единиц в соот­ветствующей строке разреженной матрицы (что также соответствует номерам столбцов единичных элементов в плотной матрице),\\[12pt]
	нумерация столбцов в плотной матрице производится с нуля
	}
	\item[$\bullet$]{вершины, в которые входят ребра с общими метками, соединяются реб­ром с этими метками.}
\end{itemize}
\
\\[0pt]
\indent Для системы \eqref{eq:matrix2} и соответствующей ее разреженной матрицы граф выглядит следующим образом:

\clearpage
\noindent\textbf{Пример 1.}
\\[18pt]
\underline{\hspace{1.5em} Плотная матрица \hspace{1.5em} | \hspace{1em} Разреженная матрица \hspace{1em} | \hspace{3em} Граф \hspace{3.5em}}\\

\[
\hspace{1em}{\footnotesize
\parbox[b][5cm][t]{50mm}{
	\bordermatrix{
		& |00\ra & |01\ra & |10\ra & |11\ra \cr
		& 0 & 1 & 1 & 0 \cr
		& 0 & 0 & 0 & 1 \cr
		& 0 & 0 & 0 & 1 \cr
		& 0 & 0 & 0 & 0 \cr
		& 0 & 0 & 0 & 0 \cr
		& 1 & 0 & 0 & 0 \cr
		& 1 & 0 & 0 & 0 \cr
		& 0 & 1 & 1 & 0 \cr
	}
}
\hfill
\hspace{9.5em}\parbox[b][5cm][t]{35mm}{
	\begin{flushleft}
		1,2\\
		3\\
		3\\
		0\\
		0\\
		1,2
	\end{flushleft}
}
\hfill
\hspace{1.5em}\parbox[b][5cm][t]{50mm}{
	\includegraphics[width=36mm]{Dissertation/images/section_4/graph1.eps}
}
}\label{eq:graph}
\]

Данный граф позволяет производить вычитание строк, и таким образом, чтобы отрицательные числа не появлялись в соответствующей ему плотной матрице системы. Удаление дубликатов и вычитание строк друг из друга выполняются путем удаления соответствующих ребер графа. 

Вершины, не имеющие входных и выходных ребер, удаляются, что соответствует удалению нулевых строк в исходной матрице в результате элементарных преобразований.

\[
{\small
\begin{pmatrix}
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \cr
    0 & \fbox{1} & 0 & \fbox{1} & \fbox{1} & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \cr
    0 & \fbox{1} & 0 & \fbox{1} & 0 & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots
\end{pmatrix}
\rightarrow
\begin{pmatrix}
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \cr
    0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \cr
    0 & \fbox{1} & 0 & \fbox{1} & 0 & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots
\end{pmatrix}
}
\]

\[
{\small
\begin{pmatrix}
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \cr
    0 & \fbox{1} & 0 & \fbox{1} & 0 & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \cr
    0 & \fbox{1} & 0 & \fbox{1} & \fbox{1} & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots
\end{pmatrix}
\rightarrow
\begin{pmatrix}
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \cr
    0 & \fbox{1} & 0 & \fbox{1} & 0 & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \cr
    0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots
\end{pmatrix}
}
\]

\[
{\small
\begin{pmatrix}
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cr
    0 & \fbox{1} & \fbox{1} & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cr
    0 & \fbox{1} & \fbox{1} & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cr
    0 & \fbox{1} & \fbox{1} & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cr
    0 & \fbox{1} & \fbox{1} & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots
\end{pmatrix}
\rightarrow
\begin{pmatrix}
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cr
    0 & \fbox{1} & \fbox{1} & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots
\end{pmatrix}
}
\]

Другим словами, это вычитания из «старшей» строки $A$ «младшей» стро­ки $B$, при которых строка $A$ содержит все единицы строки $B$ на тех же позициях, но, кроме того, может также содержать единицы на позициях, кото­рые отсутствуют в строке $B$. Соответствующие вершины $A'$ и $B'$ графа будут соединены ребром (с ненулевым множеством меток), а множество меток ребра, входящего в вершину $B'$, будет подмножеством меток ребра, входящего в вер­шину $A'$.
\\[24pt]
\noindent Для матрицы
\[
{\small
\begin{pmatrix}
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \cr
    0 & \fbox{1} & 0 & \fbox{1} & \fbox{1} & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \cr
    0 & \fbox{1} & 0 & \fbox{1} & 0 & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots
\end{pmatrix}
}
\]
возможны следующие фрагменты соответствующего ей графа (двух типов):

\begin{figure}[h!]
	\noindent\centering{
		\includegraphics[width=0.45\textwidth]{Dissertation/images/section_4/A.png}
	}
\end{figure}

\clearpage
\noindent Аналогично для матрицы
\[
{\small
\begin{pmatrix}
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \cr
    0 & \fbox{1} & 0 & \fbox{1} & 0 & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \cr
    0 & \fbox{1} & 0 & \fbox{1} & \fbox{1} & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots
\end{pmatrix}
}
\]

\begin{figure}[h!]
	\noindent\centering{
		\includegraphics[width=0.17\textwidth]{Dissertation/images/section_4/B.png}
	}
\end{figure}

\noindent и для случая строк-дубликатов

\[
{\small
\begin{pmatrix}
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cr
    0 & \fbox{1} & \fbox{1} & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cr
    0 & \fbox{1} & \fbox{1} & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cr
    0 & \fbox{1} & \fbox{1} & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cr
    0 & \fbox{1} & \fbox{1} & \fbox{1} & \fbox{1} & 0 & \fbox{1} \cr
    \cdots & \cdots & \cdots & \cdots & \cdots & \cdots & \cdots
\end{pmatrix}
}
\]

\begin{figure}[h!]
	\noindent\centering{
		\includegraphics[width=0.12\textwidth]{Dissertation/images/section_4/C.png}
	}
\end{figure}

\clearpage
Удаление ребер в \textbf{примере 1} происходит следующим образом:

\begin{figure}[h!]
	\noindent\centering{
		\includegraphics[width=0.23	\textwidth]{Dissertation/images/section_4/graph2.eps}
	}
\end{figure}

Плотная матрица, соответствующая редуцированному графу, после эле­ментарных преобразований будет иметь вид:
\[
{\small
	\bordermatrix{
		& |00\ra & |01\ra & |10\ra & |11\ra \cr
		& 1 & 0 & 0 & 0 \cr
		& 0 & 1 & 1 & 0 \cr
		& 0 & 0 & 0 & 1
	}
}
\]
\
\\[12pt]
\noindent Рассмотрим более сложный пример:

\noindent\textbf{Пример 2.}
\[
{\small
A =
\begin{pmatrix}
	\cdots & \cdots & \cdots & \cdots & \cdots\\
	1 & 0 & 0 & 0 & 1 \cr
	0 & 1 & 0 & 0 & 0 \cr
	1 & 0 & 0 & 1 & 1 \cr
	0 & 0 & 1 & 0 & 0 \cr
	\cdots & \cdots & \cdots & \cdots & \cdots
\end{pmatrix}.
}
\]

\noindent Соответствующие преобразования графа:
\begin{figure}[h]
	\noindent\centering{
		\includegraphics[width=140mm]{Dissertation/images/section_4/graph7.eps}
	}
	\label{figCurves}
\end{figure}

\clearpage
Последний пример демонстрирует возможность удаления дубликатов и вычитания строк, находящихся на расстоянии. «Проход» по цепочке связанных вершин может осуществляться как сверху вниз, так и снизу вверх. Для это­го достаточно определять пересечения меток ребер, входящих и выходящих в связанные вершины. В результате мы избегаем сравнения строк между собой, поиска совпадающих пар и использования операции деления с неизбежным воз­никновением вещественных чисел в ходе элементарных преобразований.

Предложенный подход позволяет на несколько порядков сократить экспо­ненциально растущую с ростом $n$ размерность плотной матрицы системы. К примеру, для 21 атома десятки миллиардов строк в исходной матрице системы будут <<коллапсированы>> до не более чем десяти тысяч строк, что позволит в дальнейшем произвести точное вычисление ее ранга.

Представленный алгоритм является параллельным и производит редукцию графа, распределенного по сетке процессоров: разреженные матрицы считываются параллельно <<ленточным>> образом (каждый процесс считывает свою часть матрицы и формирует свою часть общего графа). Если связанные вершины принадлежат разным процессам, информация об этом (номера вер­шин и множества меток, соответствующих входящим и выходящим ребрам) пересылается в неблокирующем режиме (MPI\_Isend, MPI\_Irecv). При необхо­димости удаления вершин и/или ребер соответствующая информация также пересылается между процессами.

Работа алгоритма начинается с удаления дубликатов строк каждым про­цессом, а именно с сокращения длин тех цепочек, в которых множество меток соединяющих их ребер будет общим для всех вершин. В результате данной процедуры каждая строка матрицы будет содержаться в одном экземпляре, а вершины, отвечающие дубликатам строк, будут удалены. После чего произво­дится процесс вычитания таких строк из других в порядке обхода кратности вершин, соответствующих этим строкам. Кратность вершины в данном случае есть число входящих в нее ребер с отличными друг от друга множествами ме­ток. Данная процедура приводит к появлению строк-дубликатов: в этом случае вновь запускается процесс их удаления с возможной рассылкой информации об этом другим процессорам.

Вся процедура повторяется до тех пор, пока в матрице не остается ни одной пары строк, которые можно было бы вычесть друг из друга:
\begin{itemize}
\item{каждый отдельный процессор не может удалить ребро или вершину,}
\item{невозможно удалить ребро, соединяющее вершины, находящиеся на раз­ных процессорах.}
\end{itemize}

Выполнение работы данного алгоритма производилось на суперкомпью­ тере Ломоносов-2 с использованием 256 процессорных узлов, содержащих 2048 процессорных ядер. Максимально доступное число атомов в рамках имеющихся в распоряжении вычислительных ресурсов для поставленной задачи состави­ло 21.

\subsection{Окончательное целочисленное приведение матрицы к ступенчатой форме с помощью алгоритма Гаусса}\label{subsec:ch4/subsect3}
Результат второго этапа --- получение матрицы значительно меньшего размера, не содержащей дубликатов строк, прошедшую процесс элементарных преобразований над строками. Ее достаточно просто восстановить по редуци­рованному графу. Количество строк в такой матрице на несколько порядков отличается от числа строк в исходной плотной матрице системы. Окончатель­ное приведение матрицы к ступенчатому виду производится с применением алгоритма Гаусса в целых числах, допускающего следующие операции:
\begin{itemize}
\item{сложение и вычитание строк,}
\item{перестановка строк,}
\item{целочисленное умножение и деление строки на число.}
\end{itemize}

В результате умножений строк на число и вычитаний в матрице появля­ются отрицательные числа, а также числа, по модулю существенно большие единицы. В процессе вычислений было обнаружено, что рост абсолютных зна­чений не является неограниченным и не приводит к переполнению типа (в данном случае использовался 4-байтный тип $\mathsf{int}$). Это эмпирический факт, кото­рый позволил произвести процесс точного вычисления ранга матрицы до конца. В случае возникшего переполнения типа для элементов матрицы были бы за­ действованы большеразмерные типы ($\mathsf{long}$, $\mathsf{long~long}$), либо был бы пересмотрен подход к процедуре окончательного приведения матрицы к ступенчатому виду в пользу других альтернатив.

\clearpage
Отсутствие переполнения может объясняться рядом особенностей мат­рицы, полученной на этапе 2:
\begin{itemize}
\item{значительная часть строк матрицы соответствует строками единичной матрицы и в ходе процедуры приведения матрицы к ступенчатому виду требует лишь перестановки,}
\item{размерность матрицы на несколько порядков меньше размерности ис­ходной матрицы,}
\item{матрица является значительно более разреженной, чем исходная мат­рица: строки, изначально состоящие практически целиком из единиц стали в еще большей степени разреженными, поскольку из них вычи­тались строки с меньшим количеством единиц, в том числе, и строки единичной матрицы.}
\end{itemize}
\
\\
\indent По окончании данного этапа плотная матрица системы, сокращенная в своей в размерности на этапе 2, приводится к единичному виду и ее ранг соот­ветствует количеству ее строк.
\\[12pt]
\indent По итогам работы алгоритма размерность темного подпространства трех­уровневых ансамблей атомов была численно установлена для следующих значений $n = 3k$:

\noindent\begin{tabular}[t]{|p{5em}|p{3em}|p{3em}|p{3em}|p{3em}|p{4em}|p{4em}|p{4em}|}
	\hline
	$n$ & 3 & 6 & 9 & 12 & 15 & 18 & 21 \\
	\hline
	$\dim(D^{(3)}_n)$ & 1 & 5 & 28 & 165 & 1001 & 6188 & 38 760 \\
	\hline
\end{tabular}
\
\\[24pt]
\indent Для значений $n = \overline{1, 9}$ при $n$ кратном 3 мультисинглеты вида \eqref{dim_3_level} были выписаны в явном виде. Размерность линейной оболочки, натянутой на эти состояния, совпала с размерностью темного подпространства, полученной в результате работы представленного выше алгоритма, подтвердив тем самым гипотезу о структуре темного подпространства. А именно подтверждено, что для ансамблей, состоящих из $n = \overline{1, 9}~(n = 3k)$ атомов, всё множество тем­ных состояний исчерпывается мультисинглетами вида \eqref{dim_3_level} и других темных состояний в ансамблях с указанной численностью атомов нет.

\clearpage
\noindent $\textbf{n = 3:}$
\begin{figure}[h]
	\noindent{
		\includegraphics[width=1.0\textwidth]{Dissertation/images/section_4/n_3.png}
	}
	\label{figCurves}
\end{figure}

\noindent $\textbf{n = 6:}$
\begin{figure}[h]
	\noindent{
		\includegraphics[width=1.0\textwidth]{Dissertation/images/section_4/n_6.png}
	}
	\label{figCurves}
\end{figure}

\clearpage
\noindent $\textbf{n = 9:}$
\begin{figure}[h]
	\noindent{
		\includegraphics[width=0.4\textwidth]{Dissertation/images/section_4/n_9_1.png}
	}
	\label{figCurves}
\end{figure}

\begin{figure}[h]
	\noindent{
		\includegraphics[width=1.0\textwidth]{Dissertation/images/section_4/n_9_2.png}
	}
	\label{figCurves}
\end{figure}

\clearpage
\section{Выводы главы}\label{sec:ch4/sect4}
Был предложен алгоритм определения размерности темного подпростран­ства пространства многоуровных атомных ансамблей, основанный на целочисленном вычислении ранга сверхбольшой двоичной матрицы путем параллельной редукции соответствующего ей графа.

Данный алгоритм позволил установить размерность темного подпростран­ства для ансамблей, содержащих до 21 трехуровневого атома включительно. Для некратного трем количества атомов в группе работа алгоритма завер­шилась установлением размерности темного подпространства, равной нулю, означающему отсутствие темных состояний в этом пространстве.

Гипотеза о структуре и явном виде темных состояний была подтверждена для 1, 3, 6 и 9 трехуровневых атомов в группе. Было показано, что все темные состояния в данном случае есть линейные комбинации мультисинглетов.